type Version = nat64;

type RuleId = text;

type InputRule = record {
  id: text;
  rule_raw: blob;
  description: text;
};

type OutputRule = record {
  id: text;
  rule_raw: opt blob;
  description: opt text;
};

type InputConfig = record {
  rules: vec InputRule; 
};

type OutputConfig = record {
  rules: vec OutputRule; 
};

type OverwriteConfigResponse = record {
  result: bool;
};

type ConfigResponse = record {
    version: nat64;
    active_since: nat64;
    config: OutputConfig;
};

type GetConfigResponse = variant {
  Ok: ConfigResponse;
  Err: text;
};

type DisclosesRulesResponse = record {
  result: bool;
}

service : (nat64) -> {
    get_api_boundary_nodes_count : () -> (nat64) query;
    overwrite_config: (InputConfig) -> (OverwriteConfigResponse);
    get_config: (opt Version) -> (GetConfigResponse);
    disclose_rules: (vec RuleId) -> (DisclosesRulesResponse);
}